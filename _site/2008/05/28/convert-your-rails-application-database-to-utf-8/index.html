<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Convert your Rails application database to UTF-8 &mdash; W. Andrew Loe III: Journal</title>
  <meta name="author" content="W. Andrew Loe III" />
  <meta name="generator" content="jekyll" />
 
  <link rel="stylesheet" href="http://assets.andrewloe.com/css/journal.css" type="text/css" media="screen, projection">
  <link rel="stylesheet" href="http://assets.andrewloe.com/css/syntax.css" type="text/css" media="screen, projection">
 
  <link href="/atom.xml" rel="alternate" title="W. Andrew Loe III's Atom Feed" type="application/atom+xml" />
  
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1702281-1']);
    _gaq.push(['_setDomainName', '.andrewloe.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>
<body>
<div id="nav">
  <h1><a href="/">W. Andrew Loe III: Journal</a></h1>

  <ul>
    <li><a href="/archive/">Archive</a></li>
    <li><a href="/about/">About</a></li>
    <li><a href="http://feeds.andrewloe.com/WALoeIII-Journal">Feed</a></li>
  </ul>

  <h3>search</h3>
  <form method="get" action="http://www.google.com/search">
    <input type="text" id="search" class="ti" name="q" value="" />
    <input type="hidden" name="q" value="site:journal.andrewloe.com" />
    <input type="submit" value="Search" />
  </form>

  <h3>about me</h3>
  <p>I am a web developer at 
    <a href="http://onehub.com">Onehub</a>. I like sailing, snowboarding, and computers.</p>

    <h3>more me</h3>

    <ul>
      <li>
        <a href="http://gallery.andrewloe.com/">
          gallery
        </a>
      </li>
      <li>
        <a href="http://github.com/loe">
          github
        </a>
      </li>
      <li>
        <a href="http://twitter.com/WALoeIII">
          Twitter 
        </a>
      </li>
      <li>
        <a href="http://www.facebook.com/WALoeIII">
          Facebook
          </a>
      </li>
      <li>
      <a href="http://www.linkedin.com/in/WALoeIII">
        LinkedIn
        </a>
      </li>
      <li>
        <a href="http://onehub.com/">
          Onehub
          <span>File Transfer and Online Collaboration!</span>
        </a>
      </li>
      <li>
        <a href="mailto:andrew@andrewloe.com">
          Email
        </a>
      </li>
    </ul>

</div>

<div id="content">

  <div class="post">

    <h2>Convert your Rails application database to UTF-8</h2>

    <p class="pubdate">Posted on Wednesday, May 28, 2008</p>

    Its unlikely that this will ever matter in local development, but its good practice to have your environment properly setup.

Dump your database to a file:<br />
@$ mysqldump -u root --skip-set-charset project_development > project_development.sql@

Note: If you are using <a href="http://macports.com/">MacPorts</a> for your mysql installation, @mysqldump@ will be @mysqldump5@.

Remove the character sets from the table definitions: (be careful if have the phrase ' DEFAULT CHARSET=latin1' in your data it will be removed!)<br />
@$ sed 's/ DEFAULT CHARSET=latin1//' project_development.sql@

Convert the characters in that file from latin1 to UTF-8 using <a href="http://www.gnu.org/software/libiconv/">iconv</a>:<br />
@$ iconv -f latin1 -t UTF-8 project_development.sql > project_development_utf8.sql@

Drop your existing database and recreate it with the appropriate defaults:<br />
@$ mysql -u root --execute="drop database project_development; create database project_development character set utf8 collate utf8_general_ci;"@

Repopulate your database with your converted data:<br />
@$ mysql -u root project_development < project_development_utf8.sql@

Don't forget to add the encoding to your database.yml!<br />

<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">development</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">adapter</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">mysql</span>
  <span class="l-Scalar-Plain">database</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">project_development</span>
  <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">root</span>
  <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span> 
  <span class="l-Scalar-Plain">host</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">localhost</span>
  <span class="l-Scalar-Plain">encoding</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">utf8</span>
</code></pre>
</div>

</div>

<div class="paginator">
  
    <div class="previous">&larr; <a class="previous" href="/2008/05/24/pork-and-beans/" title="Previous post: Pork and Beans">Pork and Beans</a></div>
  
  
  
    <div class="next"><a class="next" href="/2008/06/21/sunshine/" title="Next post: Sunshine!">Sunshine!</a> &rarr;</div>
  
</div>


</div>
</body>
</html>