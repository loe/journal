<!DOCTYPE html>
<html>
 
<head>
  <title>redgreen with autotest and autospec &mdash; W. Andrew Loe III: Journal</title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <meta name="author" content="W. Andrew Loe III">
  <meta name="generator" content="jekyll">
 
  <link rel="stylesheet" href="http://assets.andrewloe.com/css/journal.css" type="text/css">
  <link rel="stylesheet" href="http://assets.andrewloe.com/css/syntax.css" type="text/css">
 
  <link href="http://feeds.andrewloe.com/WALoeIII-Journal" rel="alternate" title="W. Andrew Loe III's Atom Feed" type="application/atom+xml">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1702281-1']);
    _gaq.push(['_setDomainName', '.andrewloe.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>
<body>

<div id="nav">
  <h1><a href="/">W. Andrew Loe III: Journal</a></h1>

  <ul>
    <li><a href="/archive/">Archive</a></li>
    <li><a href="/about/">About</a></li>
    <li><a href="http://feeds.andrewloe.com/WALoeIII-Journal">Feed</a></li>
  </ul>

  <h3>search</h3>
  <form method="get" action="http://www.google.com/search">
    <input type="text" id="search" class="ti" name="q" value="" />
    <input type="hidden" name="q" value="site:journal.andrewloe.com" />
    <input type="submit" value="Search" />
  </form>

  <h3>about me</h3>
  <p>I am a web developer at 
    <a href="http://onehub.com">Onehub</a>. I like sailing, kiteboarding, snowboarding, and computers.</p>

    <h3>more me</h3>

    <ul>
      <li>
        <a href="http://gallery.andrewloe.com/">
          gallery
        </a>
      </li>
      <li>
        <a href="http://github.com/loe">
          github
        </a>
      </li>
      <li>
        <a href="http://twitter.com/WALoeIII">
          Twitter 
        </a>
      </li>
      <li>
        <a href="http://www.facebook.com/WALoeIII">
          Facebook
          </a>
      </li>
      <li>
      <a href="http://www.linkedin.com/in/WALoeIII">
        LinkedIn
        </a>
      </li>
      <li>
        <a href="http://onehub.com/">
          Onehub
          <span>File Transfer and Online Collaboration!</span>
        </a>
      </li>
      <li>
        <a href="mailto:andrew@andrewloe.com">
          Email
        </a>
      </li>
    </ul>

</div>

<div id="content">

  <div class="post">

    <h2>redgreen with autotest and autospec</h2>

    <p class="pubdate">Posted on Thursday, January 28, 2010</p>

    <p>I use both RSpec and Test/Unit and the accompanying autospec and autotest. I was struggling to get coloring for both without breakage.</p>

<p>Trick is to only require redgreen/autotest if the RSPEC environmental variable is not set. Here is my ~/.autotest:</p>

<div class="highlight"><pre><code class="ruby"><span class="nb">require</span> <span class="s1">&#39;autotest/fsevent&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;autotest/growl&#39;</span>
<span class="nb">require</span> <span class="s1">&#39;redgreen/autotest&#39;</span> <span class="k">unless</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;RSPEC&#39;</span><span class="o">]</span>

<span class="no">Autotest</span><span class="o">::</span><span class="no">Growl</span><span class="o">::</span><span class="n">show_modified_files</span> <span class="o">=</span> <span class="kp">true</span>
<span class="no">Autotest</span><span class="o">::</span><span class="no">Growl</span><span class="o">::</span><span class="n">remote_notification</span> <span class="o">=</span> <span class="kp">true</span>
<span class="no">Autotest</span><span class="o">::</span><span class="no">Growl</span><span class="o">::</span><span class="n">image_dir</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;HOME&#39;</span><span class="o">]</span><span class="p">,</span> <span class="s1">&#39;.autotest-growl&#39;</span><span class="p">)</span>

<span class="no">Autotest</span><span class="o">.</span><span class="n">add_hook</span> <span class="ss">:initialize</span> <span class="k">do</span> <span class="o">|</span><span class="n">at</span><span class="o">|</span>
  <span class="n">at</span><span class="o">.</span><span class="n">sleep</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="sx">%w{.svn .hg .git vendor}</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">exception</span><span class="o">|</span> <span class="n">at</span><span class="o">.</span><span class="n">add_exception</span><span class="p">(</span><span class="n">exception</span><span class="p">)}</span>
  
  <span class="k">unless</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">empty?</span>
    <span class="k">if</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span> <span class="s1">&#39;config/environment.rb&#39;</span>
      <span class="n">at</span><span class="o">.</span><span class="n">find_directories</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="o">[</span><span class="s2">&quot;spec/</span><span class="si">#{</span><span class="no">ARGV</span><span class="o">.</span><span class="n">first</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;app/</span><span class="si">#{</span><span class="no">ARGV</span><span class="o">.</span><span class="n">first</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">]</span> <span class="p">:</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">dup</span>
    <span class="k">end</span>
  <span class="k">end</span>
  
  <span class="n">at</span><span class="o">.</span><span class="n">add_mapping</span><span class="p">(</span><span class="sr">%r%^spec/(processors|mailers|middlewares)/.*rb$%</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">filename</span><span class="p">,</span> <span class="n">_</span><span class="o">|</span> <span class="n">filename</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre>
</div>





</div>

<div class="paginator">
  
    <div class="previous">&larr; <a class="previous" href="/2010/01/04/send-me-files/" title="Previous post: Send me files!">Send me files!</a></div>
  
  
  
    <div class="next"><a class="next" href="/2010/03/03/aspen-extreme/" title="Next post: Aspen Extreme">Aspen Extreme</a> &rarr;</div>
  
</div>


</div>
</body>
</html>
